//
//  VoronoiReduction_Minimize_Data.hxx
//  Voronoi45
//
//  Created by Jean-Marie Mirebeau on 06/02/2018.
//  Copyright Â© 2018 Jean-Marie Mirebeau. All rights reserved.
//


#ifndef VoronoiReduction_Minimize_Data_h
#define VoronoiReduction_Minimize_Data_h


template<typename TS,int VD> void VoronoiFirstReduction<TS,VD>::
SetNeighbor(SimplexStateType & state, int neigh){
    assert(0<=neigh && neigh<NNeighbors(state.vertex));
    typedef LinearAlgebra::Matrix<int_least8_t,Dimension, Dimension> Mat;
    if constexpr(Dimension==1){assert(false);return;}
    if constexpr(Dimension==2){
        static constexpr std::array<Mat,NNeighbors(0)> data = {{
            {1,1,-1,-2},
            {1,0,1,1},
            {1,0,-1,1}
        }};
        const MatrixType a = MatrixType::CastCoordinates(data[neigh]);
        state.a = a*state.a;
        state.m = state.m.GramT(a);
        return;
    }
    if constexpr(Dimension==3){
        static constexpr std::array<Mat,NNeighbors(0)> data = {{
            {-1,0,0,0,1,0,1,0,1},
            {1,1,0,-1,0,-1,0,-1,0},
            {-1,0,0,1,1,0,1,0,1},
            {1,1,1,0,0,1,0,-1,-1},
            {1,1,0,-1,-1,-1,0,-1,0},
            {-1,0,0,1,1,0,0,0,1}
        }};
        const MatrixType a = MatrixType::CastCoordinates(data[neigh]);
        state.a = a*state.a;
        state.m = state.m.GramT(a);
        return;
    }
    if constexpr(Dimension==4){
        constexpr std::array<int_least8_t,NNeighbors(0)> vertex0 = {{
            1,0,1,1,1,1,1,0,1,0,1,1,1,1,1,0,1,0,1,1,1,0,1,1,1,0,1,1,0,1,1,0,1,1,1,
            1,1,0,1,1,0,1,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,0,1,0,1,1,1,1
        }};
        constexpr std::array<Mat,NNeighbors(0)> data0 = {{
            {1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1},{-1,0,0,0,0,-1,0,0,1,0,1,0,0,1,0,1},{-1,0,0,0,0,-1,0,0,1,0,1,0,0,1,0,1},{-1,0,0,0,0,1,0,0,1,0,1,0,0,0,0,1},{1,1,1,0,-1,0,0,0,0,0,-1,0,0,0,0,1},{1,0,1,0,-1,-1,0,0,0,0,-1,0,0,1,0,1},{1,0,1,0,0,-1,0,-1,0,0,-1,0,0,1,0,0},{-1,-1,-1,0,1,0,0,0,0,1,0,0,-1,0,0,1},{0,0,0,1,-1,-1,-1,0,1,0,0,-1,0,1,0,0},{1,1,0,0,0,-1,1,0,0,0,0,-1,0,0,-1,0},{-1,0,0,0,1,1,0,0,1,0,1,0,-1,0,0,1},{-1,0,-1,0,1,0,0,0,1,1,1,0,-1,0,0,1},{0,0,0,1,-1,-1,0,0,1,0,0,-1,1,1,1,0},{1,0,0,0,-1,-1,0,0,1,1,1,0,-1,0,0,1},{1,0,0,0,1,1,0,0,0,0,1,0,-1,0,0,1},{-1,0,0,0,0,-1,0,0,2,1,1,0,-1,0,0,1},{-1,0,0,0,1,1,0,0,1,0,1,0,0,0,0,1},{-2,-1,-1,0,1,0,0,0,1,1,0,0,-1,0,0,1},{1,0,0,0,0,1,0,0,1,0,1,0,-1,0,0,1},{-1,0,-1,0,0,0,-1,0,1,1,1,0,0,0,1,1},{0,0,-1,0,-1,-1,-1,0,1,0,1,0,0,1,1,1},{-1,-1,-1,0,1,0,0,0,0,1,0,0,0,0,1,1},{1,0,1,0,-1,-1,-1,-1,0,0,-1,0,0,1,0,0},{1,0,1,0,-1,-1,0,0,0,0,-1,0,0,1,1,1},{1,1,1,0,-1,0,0,0,0,0,-1,0,0,0,1,1},{1,1,1,1,0,-1,-1,-2,0,0,1,0,0,0,0,1},{1,1,1,1,0,0,1,1,0,-1,-1,-1,0,0,0,-1},{1,1,1,1,-1,0,0,1,0,-1,-1,-1,0,0,-1,-1},{1,1,0,0,0,0,1,1,-1,0,0,1,0,-1,-1,-1},{1,1,1,1,-1,0,0,1,0,-1,-1,-1,0,1,0,0},{1,1,1,1,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1},{1,1,0,0,0,-1,1,0,-1,-1,-1,-1,0,0,-1,0},{1,1,1,1,-1,-1,-1,0,0,-1,-1,-1,0,1,0,0},
            {0,1,1,1,1,1,1,1,0,0,-1,-1,0,-1,0,-1},{1,1,1,1,-1,-1,0,0,0,-1,-1,-1,1,1,1,0},{-1,0,-1,0,1,0,0,0,1,1,1,0,0,0,1,1},{0,0,-1,0,-1,-1,-1,-1,1,0,1,0,1,1,1,0},{-2,-1,-1,0,1,0,0,0,1,1,0,0,-1,0,1,1},{1,1,0,0,-1,-1,-1,-1,0,-1,0,0,1,1,1,0},{1,0,0,0,-1,-1,0,0,1,1,1,0,0,1,0,1},{-1,0,0,0,0,-1,0,0,2,1,1,0,-1,1,0,1},{1,1,0,0,-1,-1,-1,0,0,-1,0,0,0,1,1,1},{-1,-1,0,0,0,-1,0,0,1,1,1,0,0,1,0,1},{1,1,0,0,-1,-1,-1,-1,0,-1,0,0,0,0,1,0},{-1,0,0,0,0,-1,0,0,1,1,1,0,0,1,0,1},{-1,0,0,0,0,-1,0,0,1,1,1,0,0,1,0,1},{1,1,0,0,-1,0,-1,0,0,-1,0,0,0,1,1,1},{1,0,0,-1,-1,-1,-1,-1,0,0,0,1,0,1,0,1},{-1,-1,-1,-1,1,0,0,0,0,1,0,0,0,-1,0,-1},{1,1,1,1,-1,0,0,0,0,0,-1,-1,0,-1,0,-1},{1,0,0,-1,-1,-1,-1,-1,0,0,0,1,0,1,0,0},{-1,-1,-1,-1,1,0,0,0,1,1,0,0,-1,-1,0,-1},{1,0,0,-1,-1,-1,0,0,0,0,0,1,0,1,1,1},{0,0,-1,-1,1,0,0,0,0,1,1,1,0,-1,0,-1},{1,0,0,-1,0,-1,0,-1,0,0,0,1,0,1,1,1},{0,0,0,-1,1,0,0,-1,0,1,0,1,0,0,1,1},{1,0,0,0,0,1,0,0,0,0,1,0,-1,0,0,1},{-1,0,0,0,0,-1,0,0,1,0,1,0,-1,1,0,1},{1,1,0,0,0,0,-1,-1,0,-1,0,0,0,0,1,0},{-1,0,0,0,0,-1,0,0,1,1,1,0,-1,0,0,1},{-1,0,0,0,1,1,0,0,0,0,1,0,0,0,0,1},{1,0,0,0,-1,-1,0,0,0,0,1,0,0,1,0,1},{1,1,0,0,-1,0,-1,0,0,-1,0,0,0,0,1,1},{-1,0,0,0,0,-1,0,0,1,1,1,0,0,0,0,1}
        }};
        constexpr int vertex1 = 0;
        constexpr std::array<Mat,NNeighbors(1)> data1 = {{
            {1,0,0,0,0,1,0,0,-1,0,1,0,1,0,0,1},{-1,0,0,0,0,-1,0,0,1,1,1,0,0,0,0,1},{-1,-1,-1,0,1,0,0,0,0,1,0,0,0,0,1,1},{-1,0,0,0,0,-1,0,0,1,1,1,0,0,1,0,1},{-1,-1,-1,-1,1,0,0,0,0,1,0,0,-1,-1,0,-1},{1,0,0,0,0,1,0,0,0,0,1,0,1,0,0,1},{-1,-1,-1,0,1,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,-1,1,0,0,0,0,1,0,1,0,0,1},{-1,0,0,0,0,-1,0,0,1,0,1,0,0,1,0,1},{1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1}
        }};
        const MatrixType a = MatrixType::CastCoordinates(state.vertex==0 ? data0[neigh] : data1[neigh]);
        state.a = a*state.a;
        state.m = state.m.GramT(a);
        state.vertex = state.vertex==0 ? vertex0[neigh] : vertex1;
        return;
    }
    if constexpr(Dimension==5){
        constexpr std::array<int_least8_t,NNeighbors(0)> vertex0 = {{
            0,0,2,0,0,0,0,1,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,0,2,2,2,1,
            0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,2,2,0,0,0,0,
            1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,
            0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,
            0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,
            0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,
            0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,2,
            2,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,2,0,0,0,
            0,0,0,0,0,0,0,1,0,0,0,0,2,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
            0,1,0,0,0,0,0,0,0,1,0,2,2,2,0,0,0,0,2,0,0,0,0,1,0,0,0,0,1,0,0,0,0,
            0,0,1,0,0,0,0,2,2,2,0,0,0,0,0,0,1,0,0,0,0,1,0,0,2,2,2,0,0,0,0,0,0,
            1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
        }};
        
        constexpr int vertex1 = 0;
        constexpr int vertex2 = 0;
        // TODO : pruning
        constexpr std::array<Mat,NNeighbors(0)> data0 = {{
            {1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,0,1,0,1},{0,-1,0,0,0,1,0,1,0,0,1,0,0,1,0,1,0,0,0,0,1,0,1,1,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,1,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,0,1,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,-1,0,0,0,0,1,1,1,1},{1,2,0,1,0,-1,-1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,-1,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1,0,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,0,1,0,0,1,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,0,0,1,-1,0,0,-1,0,0,0,0,1,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,1,1,1,0,1},
            {1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,0,0,1,0,-1,1,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,1,2,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,1,0,1,0,-1,1,0,0,1},{1,1,0,0,0,0,1,0,0,0,1,1,1,0,0,1,2,1,1,1,1,1,0,0,-1},{-1,-1,0,0,0,0,-1,0,0,0,0,0,1,0,0,0,0,1,1,1,0,-1,0,0,-1},{-1,-1,-1,-1,-1,0,-1,-1,-1,-1,0,0,-1,-1,-1,0,-1,-1,-1,-2,-1,-1,-1,-2,-1},{0,1,1,1,1,1,1,1,1,1,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1},{1,0,0,0,-1,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,-1,0,0,0,0,1,0,0,1,1,1},{-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,0,0,0,-1},{1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,0,1,1,1,1,-1,0,0,-1},{1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,1,0,1,1,1,0,-1,0,-1},{1,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,1,1},{-1,-1,0,0,0,1,0,0,0,-1,0,1,-1,0,0,0,0,0,0,1,0,0,1,1,1},{1,0,0,0,0,-1,-1,0,-1,-1,0,1,0,0,0,0,0,1,1,1,1,0,-1,0,-1},{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,0,0,0,-1,-1,0,0,-1,0,-1},{-1,-1,-1,-1,-1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,-1},
            {-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,1,0,0,-1,-1,-1,0,-1,0,-1},{1,0,0,0,0,0,0,0,-1,-1,0,1,0,0,0,0,0,1,1,1,0,-1,-1,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,-1,0,0,0,0,0,0,-1,-1,1,0,-1,0,-1},{0,1,1,1,1,1,0,0,0,0,0,0,-1,-1,-1,0,-1,0,-1,-1,0,0,0,1,0},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,-1,-1,0,1,0,0,1,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,-1,-1,0,0,0,0,1,-1,0,1,0,1},{1,0,0,0,0,0,1,1,0,1,-1,0,0,0,1,0,0,-1,0,-1,1,0,0,1,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,0,1,0,1},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,-1,-1,0,-1},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,0,1,0,1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,-1,0,1,0,0,1,0,0,1,1,1},
            {0,-1,0,0,-1,1,0,0,0,-1,-1,0,-1,-1,0,0,0,0,0,1,0,0,1,0,0},{0,0,0,0,-1,1,0,0,0,-1,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0},{-1,-1,-1,0,-1,1,0,0,0,-1,0,0,1,-1,0,0,0,0,0,1,-1,0,-1,0,0},{1,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,1,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,1,0,0,1,1,0,1,0,0},{-1,0,0,0,0,1,0,0,0,-1,0,0,-1,0,0,0,1,0,0,1,0,0,1,1,1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,-1,-1,0,1,0,0,1,0,0,1,0,0},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,-1,-1,0,0,0,0,1,0,0,1,0,0},{1,0,0,0,0,0,1,0,1,1,-1,0,0,0,1,0,0,0,-1,-1,1,0,1,0,0},{1,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,1,0,1,0,0},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,-1,-1,0,-1},{1,0,1,1,1,-1,0,0,0,0,-1,-1,-1,-1,-1,0,0,0,-1,-1,1,0,0,1,0},
            {-1,0,-1,0,0,0,0,-1,0,0,0,1,0,0,0,0,1,0,1,1,0,0,-1,0,-1},{0,0,1,0,0,1,0,1,0,0,1,1,1,0,0,1,1,2,1,1,1,0,1,0,-1},{-1,-1,-1,-1,-1,0,0,-1,0,0,0,1,1,1,2,1,0,1,0,0,0,0,0,-1,-1},{1,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,-1,-1,0,1,1,0,1,1,0,1,0,0},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,1,0,1,0,0},{-1,0,0,0,0,1,1,1,1,1,0,-1,-1,0,0,0,0,-1,-1,-1,0,0,0,0,-1},{1,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,0,-1,0,-1,0,-1,0,0,0},{-1,0,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,0,-1,-1,-1,0,-1,0,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,-1,0,-1,-1,-1,1,0,1,0,0},{1,0,0,0,0,0,1,1,0,1,-1,0,0,0,1,0,0,-1,0,-1,1,0,1,1,0},{1,1,1,1,1,-1,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,-1,-1,0,-1},{1,0,0,0,-1,-1,0,-1,0,1,-1,-1,-1,-1,-1,0,0,1,0,1,1,1,1,0,0},{-1,-1,-1,0,-1,1,0,0,0,-1,0,0,0,-1,0,0,0,0,0,1,-1,0,-1,0,0},{-1,-1,-1,-1,-1,1,0,1,0,0,0,1,1,1,2,0,0,-1,0,0,-1,0,-1,-1,-1},
            {1,0,1,0,0,0,0,-1,0,-1,-1,-1,-1,-1,-1,-1,0,-1,0,1,1,1,1,0,0},{-1,-1,-1,0,0,1,0,0,0,-1,0,0,0,-1,-1,0,0,0,0,1,-1,0,-1,0,0},{-1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,0,-1,-1,-1,0,0,1,0,0},{-1,0,-1,0,0,1,1,0,0,0,0,0,0,-1,0,0,-1,0,0,0,0,1,1,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,1,1,0,1,1,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1,0,0,1,1,0,1},{-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,0,1,1,1,1},{1,1,1,0,0,-1,-1,-1,-1,-1,0,0,-1,0,0,0,1,1,0,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,0,1,0},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,1,1,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,1,0,1,0,0,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,1,1,1,1,0,0,0,0,0,1},{-1,0,-1,0,0,1,1,0,0,0,-1,-1,0,-1,0,0,-1,0,0,0,0,1,0,1,1},
            {1,1,0,0,0,1,1,0,1,0,0,-1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,1,1,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1},{0,1,0,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,2,1,0,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,0,1},{1,0,0,0,0,0,1,1,0,1,-2,-1,-1,-1,0,0,0,-1,0,-1,1,0,1,0,0},{1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,-1,0,-1,-1,0,0,0,-1,0,0,0,0,1,1,1},{-1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,0,1,1,1},
            {1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,1,1,0},{0,0,-1,0,0,0,0,0,1,0,1,0,1,0,0,1,1,1,0,0,-1,0,0,0,1},{-2,-1,-1,-1,0,0,0,-1,0,0,1,0,0,1,-1,1,0,1,0,0,-1,0,0,-1,0},{1,0,0,0,0,1,1,1,1,0,-1,-1,-1,0,-1,-1,0,-1,-1,0,1,0,1,0,0},{1,0,0,0,0,0,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,2,0,1,1,0},{1,0,1,0,0,1,0,1,1,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,1,0,1,1,0,0,0,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,1,1,0,1},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,0,1,1,0,1,1,1,0,1},{-1,-1,-1,0,0,1,0,0,1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,-1,0,0},{1,0,1,0,0,0,0,-1,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1,0,1,1,1,0,0},{-1,-1,0,-1,0,1,0,1,0,0,0,0,-1,0,-1,0,0,-1,0,0,-1,0,0,-1,0},{-1,0,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,1,0},{1,1,1,1,1,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,1,0,0,-1,0,0,0},
            {-1,0,0,0,0,1,1,1,1,1,0,-1,-1,0,0,0,0,-1,-1,-1,0,0,1,1,0},{1,0,0,0,0,0,1,1,1,1,-1,-1,-1,-1,0,-1,0,-1,-1,-1,1,0,1,0,0},{1,1,1,1,1,0,-1,-1,-1,-2,0,0,0,1,0,-1,-1,-1,-1,0,0,1,0,0,1},{-1,0,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,-1,-1,-1,-1,-1,0,-1,-1,0},{1,1,1,1,1,-1,-1,-1,-2,-1,-1,0,0,0,1,0,-1,-1,0,-1,1,1,0,1,0},{-1,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,0,-1,-1,-1,0,0,0,1,0},{0,0,1,1,1,1,1,1,1,1,-1,0,-1,-1,0,0,-1,-1,-1,-1,0,0,1,0,0},
            {-1,0,0,1,1,1,1,1,1,1,0,0,0,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,-1,-1,-2,-1,-1,-1,0,0,0,1,0,-1,0,-1,-1,1,1,1,0,0},{1,1,0,0,0,0,0,1,1,1,-1,0,0,0,1,-1,-2,-1,-1,-1,1,1,0,-1,-1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,1,1,0,-1,-1,-1,-1,0,0,0,0,-1},{1,1,1,1,1,0,-1,-1,-1,-2,0,0,0,1,0,-1,-1,-1,-1,0,1,2,1,1,1},{-1,0,0,0,1,1,1,1,1,1,1,0,0,1,-1,0,-1,-1,-1,-1,-1,1,0,0,1},{1,1,1,1,1,-1,-1,-1,-2,-1,-1,0,0,0,1,0,-1,-1,0,-1,1,2,1,1,1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,1,1,0,-1,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,0,-1,0,-1,-1,0,-1,-1,-1,-1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,0,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1},
            {0,1,1,1,1,1,1,1,1,1,0,0,-1,-1,-1,0,-1,0,-1,-1,0,0,0,1,0},{-1,-1,0,0,0,1,1,1,1,1,-1,0,-1,-1,0,0,-1,-1,-1,-1,0,0,1,0,0},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,1,1,1,1,0,1,1,1,0,1},{1,1,1,0,0,-1,-1,-1,-1,-1,0,0,-1,0,0,-1,0,0,0,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,2,2,1,1,0},{-1,-1,0,0,0,1,0,1,0,0,-1,0,-1,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,1,1,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,1,1,1,1,0,0,0,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,-1,-1,0,-1,0,0,-1,0,0,0,0,1,1,1,1},{-2,-1,-1,-1,0,0,0,0,-1,0,1,0,0,0,-1,1,0,0,1,0,-1,0,-1,0,0},
            {1,0,0,0,0,1,1,1,1,0,0,0,0,1,0,-1,0,-1,-1,0,0,0,1,0,1},{1,1,1,1,1,0,0,0,1,0,1,0,0,0,-1,0,0,1,0,0,-1,-1,-1,-1,0},{0,0,0,-1,0,0,0,-1,1,0,-1,-1,-1,-1,-1,1,0,1,1,0,1,1,1,0,0},{-2,-1,-1,-1,0,0,0,-1,0,0,1,0,0,0,-1,1,0,1,0,0,-1,0,0,-1,0},{1,0,0,0,0,1,1,1,1,0,-1,-1,-1,-1,-1,-1,0,-1,-1,0,1,0,1,0,0},{-1,0,0,0,0,1,1,1,1,1,-1,-1,-1,-1,0,0,0,-1,-1,-1,0,0,1,0,0},{1,0,0,0,0,0,1,1,1,1,-2,-1,-1,-1,0,0,0,-1,-1,-1,1,0,1,0,0},{1,1,0,0,0,0,0,1,1,1,-1,0,-1,-1,0,-1,-2,-1,-1,-1,1,1,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,-1,0,0,0,-1,-1,-1,-1,0,0,1,1,0},{1,0,1,0,0,0,1,0,1,1,-1,-1,0,-1,0,-1,-1,-2,-1,-1,1,1,1,0,0},{-1,-1,-1,0,0,1,1,1,1,1,0,0,1,-1,0,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,1,0,0,0,0,0,0,1,0},
            {-1,-1,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,1,1,0},{1,0,0,1,0,0,1,1,0,1,-1,-1,-1,0,0,-1,-1,-1,-2,-1,1,1,0,1,0},{1,1,1,1,1,0,-1,-1,-1,-2,-1,-1,-1,0,0,-1,-1,-1,-1,0,1,2,1,1,1},{-1,-1,0,0,0,1,1,1,1,1,0,1,0,0,1,0,-1,-1,-1,-1,0,0,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,0,0,-1},{1,1,0,0,0,0,0,1,1,1,-1,0,0,0,1,-1,-2,-1,-1,-1,1,1,1,0,0},{-1,-1,0,0,0,1,1,1,1,1,0,1,-1,0,0,0,-1,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,0,0,1,0,0,0,-1,-1,-1,-1,0,1,0,0,0,0,-1,-1,0,-1},{-1,-1,-1,0,0,1,1,1,1,1,0,1,1,0,1,0,-1,-1,-1,-1,-1,0,-1,0,0},{1,0,1,0,0,0,1,0,1,1,-1,0,0,0,1,-1,-1,-2,-1,-1,1,1,1,0,0},{-1,0,0,0,0,0,-1,0,-1,-1,1,1,0,0,0,1,1,1,1,1,-1,-1,-1,0,-1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,-1,0,0,0,0,1,0,1,1,1,1},{1,1,0,0,0,0,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,2,1,0,1},
            {1,1,0,-1,-1,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,1,0,0,-1},{-1,-1,0,0,0,1,0,0,0,-1,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,1},{1,1,0,0,0,0,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,1,1,1,1,0,0},{0,0,0,-1,-1,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,1,0,0,-1},{-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,0,-1,0,-1,-1,0,0,-1,0,-1},{1,0,0,0,0,-1,-1,0,-1,-1,0,1,0,0,0,0,1,1,1,1,1,-1,-1,0,-1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,-1,0,1,0,0,1,0,1,1,1,1},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,0,0,1,0,0,-1,0,0,0},
            {-1,0,0,0,0,1,1,1,1,1,0,-1,0,0,0,1,0,0,-1,-1,-1,-1,-1,0,-1},{1,0,0,0,0,0,-1,0,-1,-1,0,1,0,0,0,0,1,1,1,1,0,-1,-1,0,-1},{-1,0,0,0,0,1,0,0,0,-1,0,-1,-1,0,0,0,1,0,0,1,0,1,1,1,1},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,1,0,0,1,0,1,0,1,1,0,-1,0,0,0},{1,0,0,0,-1,-1,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0,0,0,0,1,1},{1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,1,0,1,1,1,0,1,1,0},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,-1,0,-1,-1,-1,1,-1,0,-1,-1},{-1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,0,0,-1,-1,-1,0,-1,0,0,-1},{1,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,0,0,1,0,0,-1,0,0,0},
            {-1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,0,0,-1,-1,-1,0,0,0,0,-1},{1,0,0,0,0,0,1,1,1,1,-1,0,0,0,1,0,0,-1,-1,-1,0,-1,0,-1,-1},{1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,1,0,1,1,1,0,0,1,0},{-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,1,1,2,1,0,0,1,0,0,0,-1,0,-1},{1,0,0,0,-1,-1,0,0,-1,1,-1,-1,-1,-1,-1,0,0,0,1,1,1,1,0,1,0},{-1,-1,-1,-1,-1,1,0,0,0,-1,1,1,1,2,1,0,0,0,0,1,-1,0,-1,-1,0},{-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,1,1,2,1,0,0,1,0,-1,0,-1,-1,-1},{1,0,0,0,-1,-1,0,0,-1,1,-1,-1,-1,-1,-1,0,0,0,1,1,1,1,0,0,-1},{-1,-1,-1,-1,-1,1,0,0,0,-1,1,1,1,2,1,0,0,0,0,1,-1,0,-1,-1,-1},{-1,0,0,0,0,1,1,1,1,1,0,0,0,0,1,0,0,-1,-1,-1,-1,-1,0,-1,-1},{0,1,0,-1,0,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,1,2,1,1,1},
            {1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,0,0,1,1,0,1,1,0,1,1},{1,1,0,1,0,-1,-1,-1,-1,-1,0,0,0,-1,0,0,1,0,1,1,0,-1,0,0,0},{1,1,0,0,0,0,-1,0,1,0,-1,-1,-1,-1,-1,-1,-1,0,-1,0,1,1,1,0,0},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,0,0,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,1,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,0,1,0,1,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,1,1},{1,0,0,0,0,1,1,1,1,0,-1,-1,0,0,0,-1,0,0,-1,0,1,1,0,1,1},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1},{0,1,0,-1,0,-1,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,2,1,1,1},{1,1,0,0,0,-1,-1,0,-1,0,-1,-1,-1,-1,-1,0,-1,0,1,0,2,2,1,1,0},{0,0,0,-1,0,-1,-1,-1,-1,-1,1,1,0,1,0,-1,0,0,0,1,0,-1,0,0,0},{-1,0,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,0,1,1,0,1,0,0,1,1,1,1},{-1,-1,0,0,0,0,0,0,-1,0,-1,0,-1,-1,0,1,0,0,1,0,0,1,1,1,1},{1,1,1,1,0,1,0,0,0,0,-1,0,-1,-1,0,-1,-1,0,-1,0,1,1,1,2,1},
            {-2,-1,-1,-1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,0,0,1,1},{1,0,0,0,0,1,1,0,1,0,-1,-1,-1,-1,-1,-1,0,0,-1,0,1,0,1,0,0},{0,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,1,1,0,1,0,-1,0,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,-1,-1,-1,-1,-1,1,1,0,1,0,1,0,1,1,0},{-1,0,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,0,1,1,0,1,0,0,0,1,1,1},{-1,-1,0,0,0,0,0,0,-1,0,-1,0,-1,-1,0,1,0,0,1,0,0,0,1,1,1},{0,0,0,-1,0,1,0,1,1,0,1,0,0,1,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,-1,-1,-1,-1,-1,0,1,0,1,0,2,0,1,1,0},{1,0,0,0,0,1,1,1,1,0,0,0,0,1,0,-1,0,-1,-1,0,0,0,0,0,1},{-2,-1,-1,-1,0,0,0,0,-1,0,1,0,1,0,-1,1,0,0,1,0,-1,0,-1,0,0},{1,0,0,0,0,0,1,0,1,1,-2,-1,-1,-1,0,0,0,0,-1,-1,1,0,1,0,0},{-2,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,0,0,1,1},
            {1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,1,0,1,1,0,0,0,0,1,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,1,1},{0,0,1,0,0,1,0,1,0,0,1,1,1,0,0,0,0,1,-1,0,1,1,2,1,1},{1,1,1,1,0,1,1,1,1,1,1,0,0,0,-1,1,1,1,0,0,1,1,0,1,0},{0,0,1,1,1,1,1,1,1,1,0,-1,0,0,0,1,0,1,1,0,0,0,1,0,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,-1,0,0,0,0,0,0,1,1,0,-1,-1,0,-1},{0,-1,0,0,0,0,0,-1,0,0,-1,0,0,0,1,-1,-1,-1,0,0,-1,-1,-1,-1,0},{1,1,0,0,0,0,1,0,0,0,1,1,1,0,0,0,1,0,-1,0,1,2,1,1,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,-1,0,0,0,-1,-1,-1,-1,0,0,0,0,1,1},{-1,0,-1,0,0,0,0,-1,0,0,0,1,0,0,0,-1,0,-1,-1,0,0,1,0,1,1},{-1,-1,0,0,0,0,-1,0,0,0,0,0,1,0,0,-1,-1,0,-1,0,0,0,1,1,1},{0,-1,0,0,0,0,0,-1,0,0,-1,-1,-1,-1,0,-1,-1,-1,0,0,0,0,0,0,1},{-1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,1,0,1,0,-1,1,0,0,1},{0,1,0,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,0,0,1,2,1,1,1},{1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,0,0,-1,-1,0,1,1,0,1,1},{1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,0,-1,0,-1,0,1,0,1,1,1},{-1,0,0,0,0,0,0,0,-1,0,1,1,0,0,0,1,0,1,1,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0},
            {-1,0,0,0,0,1,1,0,1,0,0,-1,-1,-1,-1,0,0,0,-1,0,0,0,1,0,0},{1,0,1,1,0,-1,0,0,0,0,-1,-1,-1,-1,0,0,0,0,-1,0,1,1,1,2,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1},{1,0,0,0,0,0,1,0,1,0,-1,-1,-1,-1,-1,-1,0,0,-1,0,1,0,1,0,0},{-1,0,0,0,0,1,1,0,1,0,0,0,-1,0,0,0,0,0,-1,0,0,0,1,1,1},{-1,-1,0,0,0,1,0,0,1,0,0,1,-1,0,0,0,0,0,-1,0,0,0,1,1,1},{-1,0,0,0,0,1,0,1,1,0,0,-1,0,0,0,0,0,0,-1,0,0,1,0,1,1},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1,1,0,1,0,0,1,1},{1,0,0,1,0,0,0,1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,0,1,1},{-1,0,0,-1,0,0,0,0,-1,0,1,1,0,1,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,0,0,0,0,0,0,-1,0,0,0,-1,-1,-1,1,0,0,1,0,0,0,1,1,0},{-1,0,0,0,0,0,0,0,-1,0,0,-1,-1,-1,-1,1,1,0,1,0,0,0,1,1,0},{-1,-1,0,-1,0,0,0,0,-1,0,0,0,-1,0,-1,1,0,0,1,0,0,0,1,0,0},{-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,-1,0,0,1,1,1,1},{-1,0,0,0,0,0,1,0,0,0,0,0,0,1,0,-1,0,-1,0,0,0,1,1,1,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,-1,-1,-1,0,0,-1,0,0,0,0,0,1,0},
            {-1,0,0,0,0,1,1,1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,0,0,1,0},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,1,1,0,1,0,1,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,1,1,0,0,1,1,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,0,0,1,1,1},{-1,0,0,0,0,1,1,1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,0,1,1,1},{1,0,0,0,0,0,1,1,0,0,-1,-1,-1,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{1,0,1,0,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,0,0,1,0,1},{-1,0,-1,0,0,0,0,-1,0,0,1,1,1,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,-1,0,0,0,0,-1,0,0,0,0,0,-1,-1,1,0,1,0,0,0,0,0,1,0},{-1,0,0,0,0,1,1,1,0,0,0,-1,-1,-1,-1,0,0,-1,0,0,0,0,1,1,0},{-1,-1,0,0,0,1,0,1,0,0,0,0,-1,-1,-1,0,0,-1,0,0,0,0,1,1,0},{-1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,1,1,0,-1,0,1,0,1},{1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,-1,-1,0,0,1,0,1,1,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1,0,0,0,0,0,1},{-1,0,0,0,0,2,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,0,1},{-2,-1,-1,-1,0,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,1,1,0,1,0,-1,-1,-1,0,-1,-1,0,0,-1,0,1,0,1,0,0},{1,1,1,1,0,1,0,0,0,0,-1,0,-1,-1,0,-1,-1,0,-1,0,0,1,1,1,1},
            {1,0,0,0,0,1,1,1,1,0,-1,-1,0,0,0,-1,0,0,-1,0,0,0,0,0,1},{-1,-1,0,0,0,0,0,0,0,1,-1,0,-1,-1,0,1,0,0,0,-1,0,0,1,0,0},{-1,0,0,0,0,0,1,0,0,1,-1,-1,-1,-1,0,1,0,0,0,-1,0,0,1,0,0},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,1,0,1,1,0,0,0,0,0,1},{-2,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,0,0,1,-2,-1,-1,-1,0,0,0,0,0,-1,1,0,1,0,0},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,1,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,1,0,1,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,1,0,1,1,0,0,1,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-2,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,1,1,0,1,0,-2,-1,0,0,1},{2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,2,1,1,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,1,1,1,1,0,0,0,0,0,1},{1,0,0,0,0,1,1,1,0,0,-1,-1,0,-1,-1,-1,0,-1,0,0,1,0,0,1,0},
            {2,1,1,0,0,-1,0,0,0,0,-1,-1,0,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,1,0,0,1},{0,1,0,0,0,-1,0,-1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,-1,0,0},{-1,-1,0,0,0,0,-1,0,0,0,-1,-1,-1,0,0,0,-1,0,1,0,-1,-1,0,0,1},{0,0,-1,0,0,-1,0,-1,0,0,-1,-1,-1,0,0,0,0,-1,1,0,-1,0,-1,0,1},{1,0,1,1,0,-1,0,0,0,0,-1,-1,-1,-1,0,0,0,0,-1,0,1,1,1,1,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,-1,0,0,0,-1,0,0,0,1,0,0},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,0,1,0,0},{-1,0,0,0,0,0,0,0,-1,0,1,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{1,1,0,0,0,0,1,0,0,0,0,0,-1,0,0,1,1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,1,1,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,1,0,0,-1,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,1,0,0,0,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{1,1,0,0,0,0,-1,0,1,0,0,0,-1,0,-1,-1,-1,0,-1,0,1,1,1,0,0},{1,1,0,1,0,0,0,-1,0,-1,0,0,0,-1,0,-1,0,0,0,1,0,-1,0,0,0},{1,0,0,0,0,-1,-1,0,-1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1},{0,1,0,-1,0,-1,-1,0,0,0,0,0,-1,0,0,0,-1,0,0,0,0,1,1,0,1},{1,1,0,0,0,-1,-1,0,0,1,-1,0,-1,-1,0,0,-1,0,0,-1,1,1,1,0,0},
            {-1,-1,0,0,0,0,0,0,0,1,0,0,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{0,0,0,0,1,0,0,1,0,0,1,0,0,0,-1,0,1,0,0,0,0,0,0,1,0},{-1,-1,0,0,0,0,0,0,0,1,0,1,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{1,0,1,0,0,-1,0,-1,0,1,-1,-1,0,-1,0,0,0,-1,0,-1,1,1,1,0,0},{-1,-1,-1,0,0,0,0,0,0,1,0,0,1,-1,0,1,0,0,0,-1,-1,0,-1,0,0},{1,0,0,1,0,-1,0,0,-1,1,-1,-1,-1,0,0,0,0,0,-1,-1,1,1,0,1,0},{-1,-1,-1,0,0,1,0,0,1,0,1,0,1,0,-1,0,0,0,-1,0,-1,0,-1,0,0},{-1,0,0,0,0,0,1,0,0,1,0,-1,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{0,1,0,0,1,-1,0,-1,-1,0,1,0,0,0,-1,0,0,0,1,0,0,-1,0,0,0},{1,0,1,0,0,0,0,-1,1,0,0,-1,0,0,-1,-1,0,-1,-1,0,1,1,1,0,0},
            {-1,-1,0,-1,0,1,0,1,0,0,1,0,0,1,-1,0,0,-1,0,0,-1,0,0,-1,0},{-1,0,0,0,0,0,1,0,0,1,0,0,-1,0,0,1,0,0,0,-1,0,0,1,1,0},{1,0,0,0,0,-1,1,0,0,1,-1,-1,-1,-1,0,0,0,0,0,-1,1,0,1,0,0},{1,0,1,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,1,1,0,0,0,1,0,1},{1,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1},{0,1,0,0,0,0,0,1,0,0,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{1,1,0,0,0,0,-1,1,0,0,0,0,0,-1,-1,-1,-1,-1,0,0,1,1,0,1,0},{-1,0,-1,0,0,1,1,0,0,0,0,0,0,-1,0,0,-1,0,0,0,-1,0,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1},{1,1,1,0,0,0,0,0,-1,-1,0,0,-1,0,0,-1,0,0,0,1,0,-1,0,0,0},{-1,0,0,0,0,1,1,1,0,0,0,0,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},{-1,-1,0,0,0,1,0,1,0,0,0,1,0,-1,0,0,0,-1,0,0,-1,0,0,1,1},
            {-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,1,1,0,0,0,0,0,1},{1,0,1,0,0,0,0,0,1,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,0,1},{1,0,0,0,0,0,1,1,0,0,0,-1,0,-1,-1,-1,0,-1,0,0,1,0,0,1,0},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,-1,0,0,0,0,0,0,-1,0,1,0,1,0,0,0,0,0,0,1},{0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,1,1,1},{-1,0,0,0,0,0,0,1,0,0,-1,-1,0,-1,0,-1,-1,0,0,0,-1,0,1,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,1,0,1,0,-1,0,1,0,1},{-1,0,-1,0,0,1,1,0,0,0,0,0,1,-1,0,0,-1,0,0,0,-1,0,0,1,1},{1,0,0,0,0,0,1,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,0,0,1,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,1,0,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,-1,-1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,0,1,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,-1,1,1,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,0,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,-1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,0,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,0,0,1,0,1},{-1,0,0,0,0,1,1,0,1,0,0,0,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},
            {1,0,0,0,0,0,1,0,1,0,0,-1,-1,0,-1,-1,0,0,-1,0,1,0,1,0,0},{1,0,0,1,0,0,0,1,0,0,0,0,0,-1,0,0,1,0,0,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,1,0,0,1,-1,0,0,0,0,0,-1,0,-1,0,1,0,1},{-1,0,0,0,0,1,0,1,1,0,0,-1,0,0,0,0,0,0,-1,0,-1,1,0,0,1},{1,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1,1,0,0,0,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,0,1},{1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,1,0,0,1,0,0,0,0,0,1},{-1,0,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,1,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,1,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,1,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,1,0,0,0,0,0,-1,-1,0,0,-1,0,0,0,0,0,1,0},
            {-1,0,0,0,0,1,1,1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,0,0,1,0},{1,1,0,0,0,-1,0,0,0,0,-1,-1,-1,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,-1,-1,0,0,0,-1,0,-1,0,0,0,0,0,1,0,1,1,1,0,1},{-1,-1,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,0,-1,0,0,0,1,1,1,0,0,1,0,0,1,0,-1,0,0,0,1},{1,1,0,1,0,-1,-1,0,0,0,-1,0,-1,-1,0,0,-1,0,0,0,1,1,1,1,1},{-1,0,0,0,0,0,-1,0,0,0,1,0,1,0,0,1,1,0,1,0,-1,0,0,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,1,0,0,1,1,0,1,0,-1,0,0,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,-1,0,0,1,0,0,1,0,-1,0,1,0,1},{-1,-1,0,0,0,1,0,0,0,0,0,0,-1,0,0,1,1,0,1,0,-1,0,1,0,1},{-1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,1,0,0,1,0,-1,0,0,0,1},{-1,-1,-1,0,0,1,0,0,0,0,0,1,0,0,0,1,1,1,1,0,-1,-1,0,0,1},{-1,0,0,0,0,1,1,0,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1}
        }};
        constexpr std::array<Mat,NNeighbors(1)> data1 = {{
            {1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,1,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1},{-1,-1,-1,-1,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,-1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,1,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{-1,-1,-1,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,1},{1,0,0,0,0,0,1,0,0,0,-1,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,1,1,1,0,1},{1,0,0,0,0,-1,1,0,0,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,1},{1,1,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,0,1,0,1,1,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,0,1,0,0,0,-1,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1},{1,1,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1,0,1,1,0,0,1},{1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,0,0,1,0,1,0,0,0,1}
        }};
constexpr std::array<Mat,NNeighbors(2)> data2 = {{
            {0,0,0,-1,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,-1,-1,-1,0,1},{0,-1,0,0,0,1,0,0,0,0,0,1,-1,0,0,-1,0,0,1,0,-1,-1,0,0,1},{1,0,0,0,0,-1,0,0,0,1,0,0,0,-1,0,0,1,0,0,-1,1,0,1,0,-1},{-1,0,0,0,0,0,1,0,0,0,1,0,-1,0,0,0,-1,0,1,0,-1,-1,0,0,1},{1,0,0,0,0,-1,0,0,1,0,0,0,0,0,-1,0,1,0,-1,0,1,0,1,-1,0},{-1,0,0,0,0,1,-1,0,0,0,0,0,1,0,0,0,0,-1,1,0,-1,0,-1,0,1},{0,1,0,0,0,-1,0,0,0,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0,1},{1,0,0,0,0,-1,0,0,1,0,0,-1,0,0,0,0,0,1,-1,0,0,0,-1,0,1},{-1,0,0,0,0,1,0,1,-1,0,0,1,0,0,0,0,-1,0,1,0,-1,0,-1,0,1},{1,0,0,0,0,-1,0,0,1,0,0,0,-1,0,0,0,1,0,-1,0,0,-1,0,0,1},{0,0,1,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,-1,1,0,0,0,0,0,1},{1,0,0,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1,0,-1,0,1,0},{-1,0,0,1,0,1,0,0,0,0,0,1,0,-1,0,0,0,1,-1,0,-1,-1,-1,1,1},{0,-1,0,1,0,-1,0,0,0,0,1,0,0,-1,0,0,1,1,-1,0,0,-1,-1,1,1},{1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,-1,0,0,1,0,0,0,0,0,1}
        }};
        const Mat * pa = nullptr;
        switch (state.vertex) {
            case 0:
                pa = &data0[neigh];
                state.vertex = vertex0[neigh];
                break;
            case 1:
                pa = &data1[neigh];
                state.vertex = vertex1;
                break;
            case 2:
                pa = &data2[neigh];
                state.vertex = vertex2;
                break;
            default: // Cannot happen, added due to compiler complaint
                assert(false);
        }
        const MatrixType a = MatrixType::CastCoordinates(*pa);
        state.a = a*state.a;
        state.m = state.m.GramT(a);
        return;
    }
    assert(false);
}


#endif /* VoronoiReduction_Minimize_Data_h */
